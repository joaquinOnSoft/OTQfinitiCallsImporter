# OTQfinitCallsImporter

Utility to generate a .xls file to be used as input in the **OpenText Qfiniti Data Importer**, from a folder structure provided by a client. It usually contains an Excel or CSV file generated by a 3rd party software like **Verint** or **NICE**.

> **NOTE**: It assumes an input folder structure that contains an excel file (.xls) with the metadata associated with the call recording files.  


## Command line execution 

This utility is distributed as a runnable .jar file.

These are the accepted parameters:

usage: javac -jar OTQfinitiCallsImporter-20.2.jar
 * **-c**, **--config <arg>**				(Required) JSON config name which defines the field mapping between the 3rd party metadata file and the .xls input file required by **OpenText Qfiniti Data Importer**
 * **-o**, **--output <arg>**		(Optional) Output file name. 'calls.xlsx' by default
 * **-f**, **--flatten <arg>**		(Optional) Flatten folder structure in the destiny folder. OTHER PARAMETERS WILL IGNORED except 'p' or 'path'
 * **-p**, **--path <arg>**			(Required) UNC Path to the call recordings files (.wav files) 


### Example of invocation

```
$ java -jar OTQfinitiCallsImporter-20.2.jar -c client_i_mapping.json -o call_recordinds.xls
```

### Output

Example of Excel file generated by this utility:

```
$ java -jar OTQfinitiCallsImporter-20.2.jar -c client_i_mapping.json -o call_recordinds.xls
```

| Path_Name                  | Name                      | Date_time           | duration      |
| -------------------------- | ------------------------- | ------------------- | ------------- | 
| \\\\MY_SERVER\\recordings  | file_example_WAV_1MG.wav  | 11/07/2019 23:15:43 | 33            |
| \\\\MY_SERVER\\recordings  | file_example_WAV_2MG.wav  | 11/07/2019 23:15:43 | 29            |         


| **WARNING**: Path_Name must be a UNC path. **UNC** (Universal Naming Convention) is a standard for identifying servers, printers and other resources in a network. Qfiniti Data Importer requires a UNC path to work properly |
| --- |

## JSON mapping configuration file 

The application requires a JSON mapping configuration file as input.

Let'see an example:

```json
{
	"inputType": "xls",
	"fieldFiller": [
		{
			"oname": "Path_Name",
			"ovalue": "C:\\Users\\jgarzonpena\\eclipse-workspace\\OTQfinitiCallsImporter\\src\\test\\resources\\client-i\\samples"
		},
		{
			"oname": "group_hierarchy",
			"filler": "com.opentext.qfiniti.importer.io.filler.GroupHierarchyFiller"
		}		
	],
	"fieldMapping": [
		{
			"iname": "Media Type",
			"itype": "String",
			"mapped": "false"
		},
		{
			"iname": "Recording Type",
			"itype": "String",
			"mapped": "false"
		},
		{
			"iname": "Recording ID",
			"itype": "string",
			"mapped": "false"  
		},
		{
			"iname": "Date/Time",
			"itype": "String",		 
			"mapped": "true",
			"oname": "Date_Time",
			"otype": "String",
			"transformer": "com.opentext.qfiniti.importer.io.transformer.DateMMddyyyyhhmmssaTransformer"
		},
		{
			"iname": "Recording Length",
			"itype": "String",
			"mapped": "true",
			"oname": "duration",
			"otype": "String",
			"transformer": "com.opentext.qfiniti.importer.io.transformer.HoursMinutesSecondsToSecondsTransformer"			
		},
		{
			"iname": "Direction",
			"itype": "string",
			"mapped": "false"  
		},
		{
			"iname": "Initiator Interaction Address",
			"itype": "string",
			"mapped": "true",
			"oname": "ANI",
			"otype": "String" 
		},
		{
			"iname": "Interaction Address",
			"itype": "string",
			"mapped": "true",
			"oname": "dnis",
			"otype": "String"  
		},
		{
			"iname": "Local Party Name",
			"itype": "string",
			"mapped": "true",
			"oname": "Team_Member_Name",
			"otype": "String",
			"transformer": "com.opentext.qfiniti.importer.io.transformer.LocalPartyName2TeamMemberNameTransformer"					
		},
		{
			"iname": "Scoring User",
			"itype": "string",
			"mapped": "false"  
		},
		{
			"iname": "Scoring Status",
			"itype": "string",
			"mapped": "false"  
		},
		{
			"iname": "Queue",
			"itype": "string",
			"mapped": "false"  
		},
		{
			"iname": "Interaction ID Key",
			"itype": "string",
			"mapped": "true",
			"oname": "File_Name",
			"otype": "String",
			"transformer": "com.opentext.qfiniti.importer.io.transformer.InteractionIdKey2FileNameTransformer"								  
		},
		{
			"iname": "Initiation Policy",
			"itype": "string",
			"mapped": "false"  
		},
		{
			"iname": "Related Recordings",
			"itype": "string",
			"mapped": "false"  
		},
		{
			"iname": "Customer Keyword Score",
			"itype": "string",
			"mapped": "false"  
		},
		{
			"iname": "Agent Keyword Score",
			"itype": "string",
			"mapped": "false"  
		},
		{
			"iname": "Total Keyword Score",
			"itype": "string",
			"mapped": "false"  
		}		
	]
}
```  

There are 3 main properties:
   - **inputType**: Input type. Possible values:
      - **xls**: Excel file
      - **csv**: CSV file (COMING SOON, not currently available)
   - **fieldFiller**: List of field fillers which provide a default or an automatically generated value for a given field. These are the possible values of a field filler:
      - **oname**: (Required) Output field name
      - **ovalue**: (Optional) Output default value
      - **filler**: (Optional) Class that extends **com.opentext.qfiniti.importer.io.filler.AbstractFiller** and provides an automatically generated value for this field.
      > **NOTE**: 'ovalue' field will be ignored when 'filler' property is present.
   - **fielMapping**: List of field mappings which provide a mapping between the input field and the output field. These are the possible values:
      - **iname**: (Required) Input field name
      - **itype**: Input data type. Default value "string"
      - **mapped**: Flag to indicate if the input file is exported to the ouput file
      - **oname**: (Required) Output field name
      - **otype**: Output data type. Default value "string"
      - **transformer**: (Optional) Class that implements the interface **com.opentext.qfiniti.importer.io.transformer.ITransformer** and provides some kind of processing/data manipulation for this field.
   
### Available field fillers

